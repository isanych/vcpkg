diff --git a/CMakeLists.txt b/CMakeLists.txt
index 37616eb..da9a8c5 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -251,13 +251,27 @@ if(MI_BUILD_SHARED)
   )
   if(WIN32)
     # On windows copy the mimalloc redirection dll too.
-    target_link_libraries(mimalloc PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}/bin/mimalloc-redirect.lib)
-    add_custom_command(TARGET mimalloc POST_BUILD
-      COMMAND "${CMAKE_COMMAND}" -E copy "${CMAKE_CURRENT_SOURCE_DIR}/bin/mimalloc-redirect.dll" $<TARGET_FILE_DIR:mimalloc>
-      COMMENT "Copy mimalloc-redirect.dll to output directory")
+    if(CMAKE_SIZEOF_VOID_P EQUAL 8)
+      target_link_libraries(mimalloc PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}/bin/mimalloc-redirect.lib)
+      add_custom_command(TARGET mimalloc POST_BUILD
+        COMMAND "${CMAKE_COMMAND}" -E copy "${CMAKE_CURRENT_SOURCE_DIR}/bin/mimalloc-redirect.dll" $<TARGET_FILE_DIR:mimalloc>
+        COMMENT "Copy mimalloc-redirect.dll to output directory")
+      install (
+        FILES $<TARGET_FILE_DIR:mimalloc>/mimalloc-redirect.dll
+        DESTINATION ${CMAKE_INSTALL_BINDIR}
+      )
+    elseif(CMAKE_SIZEOF_VOID_P EQUAL 4)
+      target_link_libraries(mimalloc PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}/bin/mimalloc-redirect32.lib)
+      add_custom_command(TARGET mimalloc POST_BUILD
+      COMMAND "${CMAKE_COMMAND}" -E copy "${CMAKE_CURRENT_SOURCE_DIR}/bin/mimalloc-redirect32.dll" $<TARGET_FILE_DIR:mimalloc>
+      COMMENT "Copy mimalloc-redirect32.dll to output directory")
+      install (
+        FILES $<TARGET_FILE_DIR:mimalloc>/mimalloc-redirect32.dll
+        DESTINATION ${CMAKE_INSTALL_BINDIR}
+      )
+    endif()
   endif()
-
-  install(TARGETS mimalloc EXPORT mimalloc DESTINATION ${mi_install_dir} LIBRARY)
+  install(TARGETS mimalloc EXPORT mimalloc ARCHIVE DESTINATION lib RUNTIME DESTINATION bin LIBRARY DESTINATION lib NAMELINK_SKIP)
   install(EXPORT mimalloc DESTINATION ${mi_install_dir}/cmake)
 endif()
 
@@ -280,8 +294,7 @@ if (MI_BUILD_STATIC)
   else()
     set_target_properties(mimalloc-static PROPERTIES OUTPUT_NAME ${mi_basename})
   endif()
-
-  install(TARGETS mimalloc-static EXPORT mimalloc DESTINATION ${mi_install_dir})
+  install(TARGETS mimalloc-static EXPORT mimalloc DESTINATION lib)
 endif()
 
 # install include files
diff --git a/cmake/mimalloc-config-version.cmake b/cmake/mimalloc-config-version.cmake
index 6454d91..c919185 100644
--- a/cmake/mimalloc-config-version.cmake
+++ b/cmake/mimalloc-config-version.cmake
@@ -3,6 +3,7 @@ set(mi_version_minor 6)
 set(mi_version ${mi_version_major}.${mi_version_minor})
 
 set(PACKAGE_VERSION ${mi_version})
+if(PACKAGE_FIND_VERSION_MAJOR)
 if("${PACKAGE_FIND_VERSION_MAJOR}" EQUAL "${mi_version_major}")
     if ("${PACKAGE_FIND_VERSION_MINOR}" EQUAL "${mi_version_minor}")
         set(PACKAGE_VERSION_EXACT TRUE)
@@ -14,3 +15,4 @@ if("${PACKAGE_FIND_VERSION_MAJOR}" EQUAL "${mi_version_major}")
 else()
     set(PACKAGE_VERSION_UNSUITABLE TRUE)
 endif()
+endif()
